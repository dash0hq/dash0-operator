---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.14.0
  name: dash0views.operator.dash0.com
spec:
  group: operator.dash0.com
  names:
    kind: Dash0View
    listKind: Dash0ViewList
    plural: dash0views
    singular: dash0view
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Dash0View is the Schema for the Dash0View API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: Dash0ViewSpec defines the desired state of Dash0View
            properties:
              display:
                description: Dash0ViewDisplay defines the display configuration
                properties:
                  description:
                    description: |-
                      Long-form explanation what the view is doing. Shown within the list of views to help
                      team members understand the purpose of the view.
                    type: string
                  folder:
                    description: |-
                      The name of the folder in which the view is located. For example, if
                      the view is located in the root folder, this field will be an empty array.


                      A view can only be located within a single folder. However, it can be nested.
                      Meaning, a value such as `["Shop", "Checkout"]` describes that the view is
                      residing within a folder called `Checkout` and that folder is within a folder called
                      `Shop`.
                    items:
                      type: string
                    type: array
                  name:
                    description: |-
                      Short-form name for the view to be shown prominently within the view list and atop
                      the screen when the view is selected.
                    type: string
                required:
                - name
                type: object
              filter:
                description: The filter for the whole view.
                items:
                  description: Dash0ViewFilter defines a filter condition
                  properties:
                    key:
                      description: The attribute key to be filtered.
                      type: string
                    operator:
                      description: The match operation for filtering attributes.
                      enum:
                      - is
                      - is_not
                      - is_set
                      - is_not_set
                      - is_one_of
                      - is_not_one_of
                      - gt
                      - lt
                      - gte
                      - lte
                      - matches
                      - does_not_match
                      - contains
                      - does_not_contain
                      - starts_with
                      - does_not_start_with
                      - ends_with
                      - does_not_end_with
                      - is_any
                      type: string
                    value:
                      description: AnyValue represents a value that can be a string
                        or a structured object
                      maxProperties: 1
                      minProperties: 1
                      properties:
                        arrayValue:
                          description: ArrayValue represents an array of AnyValue
                            messages
                          properties:
                            values:
                              description: Array of values. The array may be empty
                                (contain 0 elements).
                              items:
                                description: |-
                                  RawMessage is a raw encoded JSON value.
                                  It implements [Marshaler] and [Unmarshaler] and can
                                  be used to delay JSON decoding or precompute a JSON encoding.
                                format: byte
                                type: string
                              type: array
                              x-kubernetes-preserve-unknown-fields: true
                          required:
                          - values
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        boolValue:
                          type: boolean
                        bytesValue:
                          type: string
                        doubleValue:
                          type: string
                        intValue:
                          type: string
                        kvlistValue:
                          description: KvlistValue represents a list of KeyValue messages
                          properties:
                            values:
                              description: |-
                                A collection of key/value pairs of key-value pairs. The list may be empty (may contain 0 elements).
                                The keys MUST be unique (it is not allowed to have more than one value with the same key).
                              items:
                                description: KeyValue represents a key-value pair
                                  that is used to store Span attributes, Link attributes,
                                  etc.
                                properties:
                                  key:
                                    type: string
                                  value:
                                    description: |-
                                      RawMessage is a raw encoded JSON value.
                                      It implements [Marshaler] and [Unmarshaler] and can
                                      be used to delay JSON decoding or precompute a JSON encoding.
                                    format: byte
                                    type: string
                                    x-kubernetes-preserve-unknown-fields: true
                                required:
                                - key
                                - value
                                type: object
                                x-kubernetes-preserve-unknown-fields: true
                              type: array
                              x-kubernetes-preserve-unknown-fields: true
                          required:
                          - values
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        stringValue:
                          type: string
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                    values:
                      description: List of values to match against. This parameter
                        is mandatory for the is_one_of and is_not_one_of operators.
                      items:
                        description: AnyValue represents a value that can be a string
                          or a structured object
                        maxProperties: 1
                        minProperties: 1
                        properties:
                          arrayValue:
                            description: ArrayValue represents an array of AnyValue
                              messages
                            properties:
                              values:
                                description: Array of values. The array may be empty
                                  (contain 0 elements).
                                items:
                                  description: |-
                                    RawMessage is a raw encoded JSON value.
                                    It implements [Marshaler] and [Unmarshaler] and can
                                    be used to delay JSON decoding or precompute a JSON encoding.
                                  format: byte
                                  type: string
                                type: array
                                x-kubernetes-preserve-unknown-fields: true
                            required:
                            - values
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          boolValue:
                            type: boolean
                          bytesValue:
                            type: string
                          doubleValue:
                            type: string
                          intValue:
                            type: string
                          kvlistValue:
                            description: KvlistValue represents a list of KeyValue
                              messages
                            properties:
                              values:
                                description: |-
                                  A collection of key/value pairs of key-value pairs. The list may be empty (may contain 0 elements).
                                  The keys MUST be unique (it is not allowed to have more than one value with the same key).
                                items:
                                  description: KeyValue represents a key-value pair
                                    that is used to store Span attributes, Link attributes,
                                    etc.
                                  properties:
                                    key:
                                      type: string
                                    value:
                                      description: |-
                                        RawMessage is a raw encoded JSON value.
                                        It implements [Marshaler] and [Unmarshaler] and can
                                        be used to delay JSON decoding or precompute a JSON encoding.
                                      format: byte
                                      type: string
                                      x-kubernetes-preserve-unknown-fields: true
                                  required:
                                  - key
                                  - value
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                                type: array
                                x-kubernetes-preserve-unknown-fields: true
                            required:
                            - values
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          stringValue:
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      type: array
                      x-kubernetes-preserve-unknown-fields: true
                  required:
                  - key
                  - operator
                  type: object
                type: array
              groupBy:
                description: |-
                  A set of attribute keys to group the view by. This property may be missing to indicate that
                  no configuration was historically made for this view, i.e., the view was saved before the
                  grouping capability was added. In that case, you can assume a default grouping should be used.
                items:
                  type: string
                type: array
              implicitFilter:
                description: |-
                  An implicit filter the user cannot change that will always be applied to the view. It will not
                  be shown in the UI.
                items:
                  description: Dash0ViewFilter defines a filter condition
                  properties:
                    key:
                      description: The attribute key to be filtered.
                      type: string
                    operator:
                      description: The match operation for filtering attributes.
                      enum:
                      - is
                      - is_not
                      - is_set
                      - is_not_set
                      - is_one_of
                      - is_not_one_of
                      - gt
                      - lt
                      - gte
                      - lte
                      - matches
                      - does_not_match
                      - contains
                      - does_not_contain
                      - starts_with
                      - does_not_start_with
                      - ends_with
                      - does_not_end_with
                      - is_any
                      type: string
                    value:
                      description: AnyValue represents a value that can be a string
                        or a structured object
                      maxProperties: 1
                      minProperties: 1
                      properties:
                        arrayValue:
                          description: ArrayValue represents an array of AnyValue
                            messages
                          properties:
                            values:
                              description: Array of values. The array may be empty
                                (contain 0 elements).
                              items:
                                description: |-
                                  RawMessage is a raw encoded JSON value.
                                  It implements [Marshaler] and [Unmarshaler] and can
                                  be used to delay JSON decoding or precompute a JSON encoding.
                                format: byte
                                type: string
                              type: array
                              x-kubernetes-preserve-unknown-fields: true
                          required:
                          - values
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        boolValue:
                          type: boolean
                        bytesValue:
                          type: string
                        doubleValue:
                          type: string
                        intValue:
                          type: string
                        kvlistValue:
                          description: KvlistValue represents a list of KeyValue messages
                          properties:
                            values:
                              description: |-
                                A collection of key/value pairs of key-value pairs. The list may be empty (may contain 0 elements).
                                The keys MUST be unique (it is not allowed to have more than one value with the same key).
                              items:
                                description: KeyValue represents a key-value pair
                                  that is used to store Span attributes, Link attributes,
                                  etc.
                                properties:
                                  key:
                                    type: string
                                  value:
                                    description: |-
                                      RawMessage is a raw encoded JSON value.
                                      It implements [Marshaler] and [Unmarshaler] and can
                                      be used to delay JSON decoding or precompute a JSON encoding.
                                    format: byte
                                    type: string
                                    x-kubernetes-preserve-unknown-fields: true
                                required:
                                - key
                                - value
                                type: object
                                x-kubernetes-preserve-unknown-fields: true
                              type: array
                              x-kubernetes-preserve-unknown-fields: true
                          required:
                          - values
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        stringValue:
                          type: string
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                    values:
                      description: List of values to match against. This parameter
                        is mandatory for the is_one_of and is_not_one_of operators.
                      items:
                        description: AnyValue represents a value that can be a string
                          or a structured object
                        maxProperties: 1
                        minProperties: 1
                        properties:
                          arrayValue:
                            description: ArrayValue represents an array of AnyValue
                              messages
                            properties:
                              values:
                                description: Array of values. The array may be empty
                                  (contain 0 elements).
                                items:
                                  description: |-
                                    RawMessage is a raw encoded JSON value.
                                    It implements [Marshaler] and [Unmarshaler] and can
                                    be used to delay JSON decoding or precompute a JSON encoding.
                                  format: byte
                                  type: string
                                type: array
                                x-kubernetes-preserve-unknown-fields: true
                            required:
                            - values
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          boolValue:
                            type: boolean
                          bytesValue:
                            type: string
                          doubleValue:
                            type: string
                          intValue:
                            type: string
                          kvlistValue:
                            description: KvlistValue represents a list of KeyValue
                              messages
                            properties:
                              values:
                                description: |-
                                  A collection of key/value pairs of key-value pairs. The list may be empty (may contain 0 elements).
                                  The keys MUST be unique (it is not allowed to have more than one value with the same key).
                                items:
                                  description: KeyValue represents a key-value pair
                                    that is used to store Span attributes, Link attributes,
                                    etc.
                                  properties:
                                    key:
                                      type: string
                                    value:
                                      description: |-
                                        RawMessage is a raw encoded JSON value.
                                        It implements [Marshaler] and [Unmarshaler] and can
                                        be used to delay JSON decoding or precompute a JSON encoding.
                                      format: byte
                                      type: string
                                      x-kubernetes-preserve-unknown-fields: true
                                  required:
                                  - key
                                  - value
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                                type: array
                                x-kubernetes-preserve-unknown-fields: true
                            required:
                            - values
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          stringValue:
                            type: string
                        type: object
                        x-kubernetes-preserve-unknown-fields: true
                      type: array
                      x-kubernetes-preserve-unknown-fields: true
                  required:
                  - key
                  - operator
                  type: object
                type: array
              permissions:
                items:
                  description: Dash0ViewPermission defines permission settings for
                    a view
                  properties:
                    actions:
                      description: Outlines possible actions that matching views can
                        take with this view.
                      enum:
                      - views:read
                      - views:write
                      - views:delete
                      items:
                        type: string
                      type: array
                    role:
                      description: Use role identifiers such as `admin` and `basic_member`
                        to reference user groups.
                      type: string
                    teamId:
                      type: string
                    userId:
                      type: string
                  required:
                  - actions
                  type: object
                type: array
              table:
                description: Dash0ViewTable defines table configuration
                properties:
                  columns:
                    items:
                      description: Dash0ViewTableColumn defines a table column
                      properties:
                        colSize:
                          description: |-
                            A CSS grid layout sizing instruction. Supports hard-coded sizing such as `7rem`, but also `min-content`
                            and similar variants.
                          type: string
                        key:
                          description: The key of the attribute to be displayed in
                            this column. This can also be a built-in column name.
                          type: string
                        label:
                          type: string
                      required:
                      - key
                      type: object
                    type: array
                  sort:
                    description: Any attribute keys to order by.
                    items:
                      description: Dash0ViewTableSort defines sort configuration
                      properties:
                        direction:
                          default: ascending
                          enum:
                          - ascending
                          - descending
                          type: string
                        key:
                          description: Any attribute key to order by.
                          type: string
                      required:
                      - direction
                      - key
                      type: object
                    type: array
                required:
                - columns
                - sort
                type: object
              type:
                description: The view type describes where this view configuration
                  is intended to be applied in the UI.
                enum:
                - resources
                - spans
                - logs
                - metrics
                - failed_checks
                - web_events
                type: string
              visualizations:
                description: A visualization configuration for the view. We only support
                  a single visualization for now per view.
                items:
                  description: Dash0ViewVisualization defines visualization configuration
                  properties:
                    metric:
                      enum:
                      - logs_total
                      - logs_rate
                      - spans_total
                      - spans_rate
                      - spans_errors_total
                      - spans_errors_rate
                      - spans_errors_percentage
                      - spans_duration_p99
                      - spans_duration_p95
                      - spans_duration_p90
                      - spans_duration_p75
                      - spans_duration_p50
                      - spans_duration_avg
                      type: string
                    renderer:
                      description: |-
                        The renderer type for the visualization. The pattern matching is inspired by glob, where `*` can be used as a wildcard.
                        The matching prioritizes precise matches before wildcard matches.
                        If there are multiple renderers, select buttons will be added to allow toggling between the renderers.
                      enum:
                      - traces-explorer/*/outliers
                      - traces-explorer/*/red
                      - logging/*/stacked_bar
                      - resources/*/table-tree
                      - resources/overview/overview
                      - resources/services/red
                      - resources/operations/red
                      - resources/names/red
                      - resources/k8s-cron-jobs/executions
                      - resources/k8s-cron-jobs/red
                      - resources/k8s-daemon-sets/scheduled-nodes
                      - resources/k8s-daemon-sets/red
                      - resources/k8s-deployments/replicas
                      - resources/k8s-deployments/red
                      - resources/k8s-jobs/executions
                      - resources/k8s-jobs/red
                      - resources/k8s-namespaces/red
                      - resources/k8s-nodes/cpu-memory-disk
                      - resources/k8s-nodes/status
                      - resources/k8s-pods/cpu-memory
                      - resources/k8s-pods/status
                      - resources/k8s-pods/red
                      - resources/k8s-replica-sets/replicas
                      - resources/k8s-replica-sets/red
                      - resources/k8s-stateful-sets/replicas
                      - resources/k8s-stateful-sets/red
                      - resources/faas/red
                      type: string
                    renderers:
                      description: |-
                        A set of visualizations (charts) to render as part of this view. We currently only expect
                        to render a single
                      items:
                        description: Dash0ViewRenderer defines a visualization renderer.
                        enum:
                        - traces-explorer/*/outliers
                        - traces-explorer/*/red
                        - logging/*/stacked_bar
                        - resources/*/table-tree
                        - resources/overview/overview
                        - resources/services/red
                        - resources/operations/red
                        - resources/names/red
                        - resources/k8s-cron-jobs/executions
                        - resources/k8s-cron-jobs/red
                        - resources/k8s-daemon-sets/scheduled-nodes
                        - resources/k8s-daemon-sets/red
                        - resources/k8s-deployments/replicas
                        - resources/k8s-deployments/red
                        - resources/k8s-jobs/executions
                        - resources/k8s-jobs/red
                        - resources/k8s-namespaces/red
                        - resources/k8s-nodes/cpu-memory-disk
                        - resources/k8s-nodes/status
                        - resources/k8s-pods/cpu-memory
                        - resources/k8s-pods/status
                        - resources/k8s-pods/red
                        - resources/k8s-replica-sets/replicas
                        - resources/k8s-replica-sets/red
                        - resources/k8s-stateful-sets/replicas
                        - resources/k8s-stateful-sets/red
                        - resources/faas/red
                        type: string
                      type: array
                    yAxisScale:
                      description: The Y axis scale for the visualization.
                      enum:
                      - linear
                      - log10
                      type: string
                  required:
                  - renderers
                  type: object
                type: array
            required:
            - display
            - type
            type: object
          status:
            description: Dash0ViewStatus defines the observed state of Dash0View
            properties:
              synchronizationError:
                type: string
              synchronizationStatus:
                description: |-
                  Dash0ApiResourceSynchronizationStatus describes the result of synchronizing a (non-third-party) Kubernetes resource
                  (e.g. synthetic checks) to the Dash0 API.
                enum:
                - successful
                - failed
                type: string
              synchronizedAt:
                format: date-time
                type: string
              validationIssues:
                items:
                  type: string
                type: array
            required:
            - synchronizationStatus
            - synchronizedAt
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
